<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title></title>
</head>

<body>
  <canvas id="canvas" width="300" height="300"></canvas>
  <script>
    var canvas = document.getElementsByTagName("canvas")[0]
    var ctx = canvas.getContext("2d")

    var dt = prev = 0
    var raf
    var dists = []
    var sprites = []
    const D = {
      ACCBAS : 20,
      W_UP : 'u',
      W_DOWN : 'd',
      W_RIGHT : 'r',
      W_LEFT : 'l',
      STOPPED : 's',
    }
    function setup() {
      raf = requestAnimationFrame(passo)
      sprites.push(new Sprite(100,100,20,20))
      sprites.push(new Sprite(150,150,5,5,'red'))
    }

    function passo(t) {
      dt = (t - prev) / 1000;
      ctx.fillStyle = "black";
      ctx.fillRect(0, 0, canvas.width, canvas.height)
      for (var i = 0; i < sprites.length; i++) {
        sprites[i].move(dt)
        sprites[i].draw(ctx)
      }
      prev = t;
      requestAnimationFrame(passo)
    }

    function Sprite(x=0,y=0,w=5,h=5,c='blue') {
      this.x = x;
      this.y = y;
      this.w = w;
      this.h = h;
      this.vx = 0;
      this.vy = 0;
      this.ax = 0;
      this.ay = 0;
      this.color = c
      this.status = D.STOPPED
    }


    Sprite.prototype.setStatus = function(status) {
      switch (status) {
        case D.W_RIGHT:
          this.ax = D.ACCBAS;
          this.ay = 0;
          this.status = D.W_RIGHT
          break;
        case D.W_LEFT:
          this.ax = -D.ACCBAS;
          this.ay = 0;
          this.status = D.W_LEFT
          break;
        case D.W_DOWN:
          this.ax = 0;
          this.ay = D.ACCBAS;
          this.status = D.W_DOWN
          break;
        case D.W_UP:
          this.ax = 0;
          this.ay = -D.ACCBAS;
          this.status = D.W_UP
          break;
        case D.STOPPED:
          this.status = D.STOPPED
        default:
          this.status = D.STOPPED
          this.vx = 0;
          this.vy = 0;
      }
    }
    Sprite.prototype.move = function(dt) {
      this.vx += this.ax * dt
      this.x += this.vx * dt
    }
    Sprite.prototype.draw = function(ctx) {
      ctx.save()
      ctx.translate(this.x, this.y)
      ctx.fillStyle = this.color
      ctx.fillRect(-this.w / 2, -this.h / 2, this.w, this.h)
      ctx.restore()
    }

    setup()

  </script>
</body>

</html>
